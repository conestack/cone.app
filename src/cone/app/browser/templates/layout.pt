<tal:layout xmlns:tal="http://xml.zope.org/namespaces/tal"
            xmlns:ajax="http://namespaces.conestack.org/ajax"
            omit-tag="True">

  <div id="layout"
       data-base-url="${context.nodeurl}"
       class="h-100 overflow-hidden"
       ajax:action="layout:#layout:replace"
       ajax:bind="contextchanged"
       tal:define="config context.config">

    <div class="${'container-fluid' if config.columns_fluid else 'container'} h-100">

      <div class="row h-100">

        <!-- content area -->
        <div id="main-area"
             tal:define="userid context.request.authenticated_userid"
             class="col h-100 p-0 ${'pb-5' if userid else 'pb-0'}">

          <!-- header -->
          <nav id="header-main"
               tal:condition="request.has_permission('view', model)"
               class="position-relative p-0 navbar navbar-expand navbar-light shadow-sm border-bottom">

            <div id="header-content"
                 class="h-100 px-0 container-fluid">

              <!-- logo -->
              <tal:logo replace="structure tile('logo')" />

              <tal:personaltools
                condition="config.personaltools"
                replace="structure tile('personaltools')" />

              <button class="navbar-toggler border-0 shadow-none h-100"
                      data-bs-target="#navbar-content-wrapper"
                      data-bs-toggle="collapse"
                      type="button">
                <span class="navbar-toggler-icon"></span>
              </button>

              <div id="navbar-content-wrapper"
                   class="collapse shadow navbar-collapse p-0">
                <div id="navbar-content" class="d-flex align-items-center">

                  <tal:mainmenu
                    condition="config.mainmenu"
                    replace="structure tile('mainmenu')" />

                  <tal:livesearch
                    condition="config.livesearch"
                    replace="structure tile('livesearch')" />
                </div>
              </div>
            </div>

          </nav>

          <!-- pathbar-->
          <tal:pathbar
            condition="config.pathbar"
            replace="structure tile('pathbar')" />

          <div id="content_area" class="d-flex h-100">
            <!-- sidebar -->
            <div id="sidebar_left"
                tal:condition="config.sidebar_left and request.has_permission('view', model)"
                class="d-flex flex-column flex-shrink-0 pt-1 px-0 pb-5">

              <div id="sidebar_collapse">
                <div class="collapse_btn btn btn-primary">
                  <i class="bi-chevron-right text-light"></i>
                  <i class="bi-chevron-left text-light"></i>
                </div>
              </div>

              <div id="sidebar_resize">
                <div id="sidebar_resizer"></div>
              </div>

              <div class="scrollable-y scrollbar-left">
                <div class="scrollable-content px-2">
                  <ul class="nav nav-pills flex-column mb-auto">

                    <tal:tiles repeat="tilename config.sidebar_left">
                      <tal:tile replace="structure tile(tilename)" />
                    </tal:tiles>

                  </ul>
                </div>
              </div>
            </div>
            <!-- end sidebar -->
            <!-- content -->
            <div id="content"
                class="px-3 pb-5 py-2 overflow-auto"
                ajax:bind="contextchanged"
                ajax:action="content:#content:inner">
              <tal:content replace="structure tile(context.contenttile)" />
            </div>
          </div>
          <!-- end content area -->
        </div>

      </div>
    </div>

    <!-- footer -->
    <tal:footer replace="structure tile('footer')" />

  </div>

</tal:layout>
